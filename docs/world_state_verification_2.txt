[Redis] Using Mock: true (Env: true)
--- Testing World State API ---
Cleared Redis cache.
Skipping seed check (DB seeded via seed-data.ts).
Fetching state (Cache Miss expected)...
Failed to fetch treasuryBalance: InvalidAddressError: Address "undefined" is invalid.

- Address must be a hex value of 20 bytes (40 hex characters).
- Address must match its checksum counterpart.

Version: viem@2.45.1
    at encodeAddress (C:\Dev\Pontiff\node_modules\viem\utils\abi\encodeAbiParameters.ts:226:32)
    at prepareParam (C:\Dev\Pontiff\node_modules\viem\utils\abi\encodeAbiParameters.ts:162:12)
    at prepareParams (C:\Dev\Pontiff\node_modules\viem\utils\abi\encodeAbiParameters.ts:127:25)
    at encodeAbiParameters (C:\Dev\Pontiff\node_modules\viem\utils\abi\encodeAbiParameters.ts:100:26)
    at encodeFunctionData (C:\Dev\Pontiff\node_modules\viem\utils\abi\encodeFunctionData.ts:92:28)
    at readContract (C:\Dev\Pontiff\node_modules\viem\actions\public\readContract.ts:116:38)
    at Object.readContract (C:\Dev\Pontiff\node_modules\viem\clients\decorators\public.ts:2091:41)
    at getVaticanState (C:\Dev\Pontiff\apps\web\lib\services\world-state-service.ts:67:24)
    at async main (C:\Dev\Pontiff\apps\web\scripts\test-world-state.ts:19:20) {
  details: undefined,
  docsPath: undefined,
  metaMessages: [
    '- Address must be a hex value of 20 bytes (40 hex characters).',
    '- Address must match its checksum counterpart.'
  ],
  shortMessage: 'Address "undefined" is invalid.',
  version: '2.45.1'
}
Failed to fetch totalEntrants: ContractFunctionExecutionError: The contract function "getTotalEntrants" reverted.

Contract Call:
  function:  getTotalEntrants()

Docs: https://viem.sh/docs/contract/readContract
Version: viem@2.45.1
    at getContractError (C:\Dev\Pontiff\node_modules\viem\utils\errors\getContractError.ts:81:10)
    at readContract (C:\Dev\Pontiff\node_modules\viem\actions\public\readContract.ts:138:27)
    ... 3 lines matching cause stack trace ...
    at async main (C:\Dev\Pontiff\apps\web\scripts\test-world-state.ts:19:20) {
  cause: ContractFunctionRevertedError: The contract function "getTotalEntrants" reverted.
  
  Version: viem@2.45.1
      at <anonymous> (C:\Dev\Pontiff\node_modules\viem\utils\errors\getContractError.ts:68:14)
      at getContractError (C:\Dev\Pontiff\node_modules\viem\utils\errors\getContractError.ts:79:5)
      at readContract (C:\Dev\Pontiff\node_modules\viem\actions\public\readContract.ts:138:27)
      at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
      at async Promise.all (index 0)
      at async getVaticanState (C:\Dev\Pontiff\apps\web\lib\services\world-state-service.ts:52:50)
      at async main (C:\Dev\Pontiff\apps\web\scripts\test-world-state.ts:19:20) {
    details: undefined,
    docsPath: undefined,
    metaMessages: undefined,
    shortMessage: 'The contract function "getTotalEntrants" reverted.',
    version: '2.45.1',
    data: undefined,
    raw: '0x',
    reason: 'execution reverted',
    signature: undefined
  },
  details: undefined,
  docsPath: '/docs/contract/readContract',
  metaMessages: [ 'Contract Call:', '  function:  getTotalEntrants()' ],
  shortMessage: 'The contract function "getTotalEntrants" reverted.',
  version: '2.45.1',
  abi: [
    {
      name: 'getTotalEntrants',
      type: 'function',
      stateMutability: 'view',
      inputs: [],
      outputs: [Array]
    },
    {
      name: 'entryFee',
      type: 'function',
      stateMutability: 'view',
      inputs: [],
      outputs: [Array]
    }
  ],
  args: undefined,
  contractAddress: undefined,
  formattedArgs: undefined,
  functionName: 'getTotalEntrants',
  sender: undefined
}
Fetch 1 took 5162ms
State 1 Betrayal %: 15
Fetching state again (Cache Hit expected)...
Fetch 2 took 0ms
SUCCESS: Cache hit appears to work (sub-50ms).
SUCCESS: States match.
Redis Key TTL: 10s
